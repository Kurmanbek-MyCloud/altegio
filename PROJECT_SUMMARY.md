# Altegio Payments Integration - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

## üéØ –ß—Ç–æ —ç—Ç–æ

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –≤ Altegio —á–µ—Ä–µ–∑ API. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–ª–∞—Ç–µ–∂–∏** —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏
2. **API endpoint** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –∑–∞–ø—Ä–æ—Å—É

## üìÅ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `main.php` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–µ–±—Ö—É–∫–æ–≤ Altegio (16KB)
- `api_endpoint.php` - API endpoint –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ (5KB)
- `altegio_payments.php` - –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API Altegio (16KB)
- `config.php` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (6KB)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `test_webhook.html` - —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤ (18KB)
- `test_api_client.html` - —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è API (10KB)
- `test_api_simple.php` - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç API (2KB)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `README.md` - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (4KB)
- `PAYMENTS_GUIDE.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º (6KB)
- `API_DOCUMENTATION.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (5KB)
- `PROJECT_SUMMARY.md` - –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (2KB)

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–æ–∫–µ–Ω—ã** –≤ `config.php`:
   ```php
   'user_token' => 'c1d3041f2185df70f5c341f0926adb44',
   'partner_token' => 'gbkp3f4ynkd5jpejjsxp',
   'company_id' => 729142,
   'account_id' => 2665932,
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –≤–µ–±—Ö—É–∫** –≤ –∫–∞–±–∏–Ω–µ—Ç–µ Altegio:
   - URL: `https://your-domain.com/main.php`
   - –°–æ–±—ã—Ç–∏—è: `record.create`, `visit.completed`

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**:
   ```bash
   php -S localhost:8000
   ```

## üöÄ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –†–µ–∂–∏–º 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–ª–∞—Ç–µ–∂–∏ (–≤–µ–±—Ö—É–∫–∏)
1. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏** –≤ Altegio —Å —É—Å–ª—É–≥–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é > 0 RUB
2. **–í–µ–±—Ö—É–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è** –Ω–∞ `main.php`
3. **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂** —á–µ—Ä–µ–∑ API Altegio
4. **–ü–ª–∞—Ç–µ–∂ –ø–æ—è–≤–ª—è–µ—Ç—Å—è** –≤ –∫–∞—Å—Å–µ Altegio

### –†–µ–∂–∏–º 2: API endpoint
1. **–ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å** –Ω–∞ `api_endpoint.php`
2. **–ù–∞—à –∫–æ–¥ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ** –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ Altegio
3. **Altegio —Å–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂** –≤ —Å–≤–æ–µ–π —Å–∏—Å—Ç–µ–º–µ
4. **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç** —Å ID –ø–ª–∞—Ç–µ–∂–∞

## üì° API Endpoint

```
POST /api_endpoint.php
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `client_id` - ID –∫–ª–∏–µ–Ω—Ç–∞ –≤ Altegio
- `amount` - —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `payment_method` - —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã (cash/card/online)
- `currency` - –≤–∞–ª—é—Ç–∞ (RUB/USD/EUR)
- `master_id` - ID –º–∞—Å—Ç–µ—Ä–∞
- `comment` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞. –°–æ–∑–¥–∞–Ω–æ 4 —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–∞:
- ID: 525636601 (1500 RUB) - —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏
- ID: 525636602 (2000 RUB) - —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏  
- ID: 525637218 (2000 RUB) - —á–µ—Ä–µ–∑ API endpoint
- ID: 525637247 (2000 RUB) - —á–µ—Ä–µ–∑ API endpoint

## üìä –õ–æ–≥–∏

–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç –ª–æ–≥–∏ –≤:
- `webhook_log.txt` - –ª–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤
- `api_endpoint.log` - –ª–æ–≥–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤
- `payments_api.log` - –ª–æ–≥–∏ API Altegio
- `notifications.txt` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ (–¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- CORS –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è API

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö
2. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤ –≤ `config.php`
3. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API Altegio
4. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å ID –∫–∞—Å—Å—ã –∏ –∫–æ–º–ø–∞–Ω–∏–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- **–í–µ–±—Ö—É–∫–∏**: –æ—Ç–∫—Ä–æ–π—Ç–µ `test_webhook.html`
- **API**: –æ—Ç–∫—Ä–æ–π—Ç–µ `test_api_client.html` –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `test_api_simple.php` 